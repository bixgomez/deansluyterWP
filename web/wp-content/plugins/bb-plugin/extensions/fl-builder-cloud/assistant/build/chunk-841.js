"use strict";(self.webpackChunkfl_assistant=self.webpackChunkfl_assistant||[]).push([[841],{7841:(e,t,r)=>{r.d(t,{u:()=>X,w:()=>j});var a={};r.r(a),r.d(a,{getActions:()=>D});var n={};r.r(n),r.d(n,{getActions:()=>N});var s={};r.r(s),r.d(s,{getActions:()=>O});var i={};r.r(i),r.d(i,{getActions:()=>W});var l={};r.r(l),r.d(l,{getActions:()=>H});var o={};r.r(o),r.d(o,{getActions:()=>V});var c={};r.r(c),r.d(c,{code:()=>o,document:()=>i,image:()=>n,post:()=>a,svg:()=>s,theme_settings:()=>l});var u=r(1594),m=r.n(u),d=r(9665),p=r(2470),_=r(4495),h=r(2405),g=r(6075),y=r(2578);const b=()=>{const e=(0,d.useHistory)(),{cloudUser:t}=(0,g.useSystemState)(),{pathname:r}=(0,d.useLocation)(),{isReadOnly:a,library:n,items:s,showUpload:i,setShowUpload:l,showFilters:o,setShowFilters:c}=_.uC.LibraryContext.use(),u=`/libraries/${n.id}`,b=t.id===n.permissions.permissions_user_id,{isSelecting:E,setIsSelecting:f}=y.Selection.use(),C=s&&!!s.length;if(!(n.permissions.update||n.permissions.edit_items||n.permissions.shared||b))return null;return m().createElement(m().Fragment,null,C&&!r.includes("/settings")&&m().createElement(m().Fragment,null,m().createElement(h.Button,{onClick:()=>f(!0),isSelected:E},(0,p.__)("Select")),m().createElement(h.Button,{appearance:"transparent",isSelected:o,onClick:()=>c(!o),title:(0,p.__)("Search")},m().createElement(h.Icon.Search,null))),!a&&n.permissions.edit_items&&m().createElement(h.Button,{appearance:"transparent",isSelected:i&&!r.includes("/settings"),title:(0,p.__)("Add Items"),onClick:()=>{l(!i),r!==u&&e.goBack()},style:{marginLeft:"auto"}},m().createElement(h.Icon.Plus,null)),(n.permissions.update||n.permissions.shared||b)&&m().createElement(h.Button,{appearance:"transparent",isSelected:r.includes("/settings"),title:(0,p.__)("Settings"),onClick:()=>{r===u&&e.push(`${u}/settings`)}},m().createElement(h.Icon.Cog,null)))};var E=r(8168);const f=()=>{const{isReadOnly:e,library:t,showUpload:r,uploader:a}=_.uC.LibraryContext.use();return e||!t.permissions.edit_items?null:m().createElement(m().Fragment,null,r&&m().createElement(_.uC.LibraryUpload,null),!!a.queuedFiles.length&&m().createElement(h.Layout.Box,{padY:!1},m().createElement(_.d9.FileList,{files:a.queuedFiles})))},C=()=>{const{library:e}=_.uC.LibraryContext.use();return m().createElement(m().Fragment,null,m().createElement(h.Layout.Box,{style:{textAlign:"center",padding:0}},m().createElement(h.Layout.Headline,{style:{margin:20}},e.name),e.description&&m().createElement("div",{style:{lineHeight:1.4,margin:"0 20px"}},e.description)),m().createElement(_.uC.LibraryMemberThumbs,null))},w=e=>{const{useItemsFilter:t}=(0,g.getAppHooks)("libraries"),[r,a]=t(),{defaultItemsFilter:n,showFilters:s}=(0,g.useAppState)("libraries",["defaultItemsFilter","showFilters"]),i=()=>"type"===r.viewBy?m().createElement(h.Filter.RadioGroupItem,{title:(0,p.__)("Type"),items:_.uC.getItemTypeOptions(),value:r.type,defaultValue:n.type,onChange:e=>a({...r,type:e})}):m().createElement(h.Filter.RadioGroupItem,{title:(0,p.__)("Collection"),items:_.uC.getCollectionOptions(),value:r.collection,defaultValue:n.collection,onChange:e=>a({...r,collection:e})});return m().createElement(m().Fragment,null,m().createElement(h.Filter,e,s&&m().createElement(h.Filter.TextInputItem,{className:"fl-asst-filter-item-full-width fl-asst-filter-item-search",title:(0,p.__)("Search"),placeholder:(0,p.__)("Filter..."),value:r.search,onChange:e=>a({...r,search:e})}),m().createElement(h.Filter.RadioGroupItem,{title:(0,p.__)("View By"),items:{type:(0,p.__)("Type"),collection:(0,p.__)("Collection")},value:r.viewBy,defaultValue:n.viewBy,onChange:e=>a({...r,viewBy:e})}),m().createElement(i,null),m().createElement(h.Filter.RadioGroupItem,{title:(0,p.__)("Sort By"),items:{name:(0,p.__)("Title"),created_at:(0,p.__)("Date Created"),updated_at:(0,p.__)("Last Updated")},value:r.orderBy,defaultValue:n.orderBy,onChange:e=>a({...r,orderBy:e})}),m().createElement(h.Filter.RadioGroupItem,{title:(0,p.__)("Order"),items:{ASC:(0,p.__)("Ascending"),DESC:(0,p.__)("Descending")},value:r.order,defaultValue:n.order,onChange:e=>a({...r,order:e})}),m().createElement(h.Filter.Button,{onClick:()=>a(n)},(0,p.__)("Reset Filter"))))};var v=r(816),S=r.n(v);const I=()=>{const{items:e,setItems:t}=_.uC.LibraryContext.use(),{items:r,clearSelection:a,totalSelectedItems:n}=y.Selection.use();return React.createElement(h.Button,{status:"destructive",icon:React.createElement(h.Icon.Trash,null),disabled:0>=n,onClick:()=>{confirm((0,p.__)("Do you really want to delete these items?"))&&(async(n=[])=>{S().libraries.deleteItem(n).finally((()=>{t([...e.filter((e=>!r.includes(e.id)))]),a()}))})(r)}},(0,p.__)("Delete"))};var L=r(9489);const R=()=>{const e=(0,L.getWpRest)().libraries(),t=(0,u.useRef)(0),r=(t,r,n)=>{e.importPostThumb(t.id,r.media.thumb).finally((()=>{a(t,r,n)}))},a=(r,n,s)=>{const{attachments:i}=n.media;if(void 0===i)return void s(r);const l=i[t.current];void 0===l?(t.current=0,s(r)):e.importPostMedia(r.id,l).finally((()=>{t.current++,a(r,n,s)}))};return(e,t)=>new Promise((n=>{t.media.thumb?r(e,t,n):a(e,t,n)}))},k=()=>{const{items:e,setItems:t,createNotice:r}=_.uC.LibraryContext.use(),{items:a,clearSelection:n,totalSelectedItems:s}=y.Selection.use(),[i,l]=(0,u.useState)(null),[o,c]=(0,u.useState)(0),m=R(),d=(0,L.getWpRest)().libraries();return React.createElement(React.Fragment,null,React.createElement(h.Button,{disabled:null!==i,onClick:async()=>{let t=0,s=0,i=[];for(const r of a){const a=e.find((e=>e.id===r));void 0!==a&&(l(a),"color"===a.type||"theme_settings"===a.type||"code"===a.type||("post"===a.type?await S().libraries.getItem(a.id).then((async e=>{await d.importPost(e.data).then((async t=>{if(t.data.error&&"post_type_not_registered"===t.data.error_code)return i.push({name:a.name,type:t.data.post_type}),void s++;await m(t.data,e.data)}))})):await d.importItem(a))),t++,c(t)}const o=i.map((e=>React.createElement("li",{key:e.name},e.name," (",e.type,")")));r(s<t?{status:"success",shouldDismiss:!1,content:React.createElement(React.Fragment,null,(0,p.__)("Library items imported!"),s>0&&React.createElement(React.Fragment,null," ",(0,p.__)("Some items were not able to be imported due to these post types not being registered on this site: "),React.createElement("br",null),React.createElement("ul",null,o)))}:{status:"error",shouldDismiss:!1,content:React.createElement(React.Fragment,null,(0,p.__)("The selected items were not able to be imported due to these post types not being registered on this site: "),React.createElement("br",null),React.createElement("ul",null,o))}),c(0),n()}},(0,p.__)("Import")),null!==i&&React.createElement("div",{className:"fl-asst-import-bar"},React.createElement("p",null,(0,p.__)("Import in progress. Navigating away from this view will stop the import process!")),React.createElement(F,{progress:o/a.length*100}),React.createElement("p",{style:{fontStyle:"italic",fontSize:"12px",marginTop:"var(--fluid-sm-space)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},(0,p.__)("Importing")," ",i.name)))},F=({progress:e})=>React.createElement("div",{style:{background:"var(--fluid-transparent-10)",borderRadius:"var(--fluid-radius)",height:"6px"}},React.createElement("div",{style:{background:"var(--fluid-transparent-4)",borderRadius:"var(--fluid-radius)",height:"6px",width:`${e}%`}})),x=({children:e,...t})=>{const{isReadOnly:r,library:a,uploader:n}=_.uC.LibraryContext.use();return!r&&a.permissions.edit_items?m().createElement(h.Layout.DropArea,(0,E.A)({onDrop:n.handleDrop},t),e):m().createElement("div",t,e)},B=()=>{const e=(0,d.useLocation)(),{items:t,showUpload:r,library:a}=_.uC.LibraryContext.use(),{defaultItemsFilter:n}=(0,g.useAppState)("libraries","defaultItemsFilter"),{useItemsFilter:s}=(0,g.getAppHooks)("libraries"),[i,l]=s(),o=_.uC.getFilteredItems(i,t),c=t&&!!t.length,{isSelecting:u}=y.Selection.use(),b=a.permissions.edit_items&&!((e,t=[])=>t.some((t=>e.endsWith(t))))(e.pathname,["/share","/settings","/collections"]);return m().createElement(x,{className:"fl-asst-library-content"},m().createElement("div",{className:"fl-asst-library-sticky"},m().createElement(w,null),u&&m().createElement(y.Selection.Toolbar,{style:{minHeight:48,flexBasis:48,width:"100%",top:"auto"},isSticky:!1},m().createElement(k,null),m().createElement(I,null))),m().createElement(y.Selection.Box,{itemSelector:".fluid-collection-item",mapElementToData:e=>parseInt(e.dataset.selectionId),isEnabled:b},m().createElement(C,null),m().createElement(f,null),m().createElement(_.uC.ItemsList,null),(()=>{const{viewBy:e,type:r,collection:a}=i;if(t&&!Object.keys(o).length){if("type"===e&&"all"!==r)return!0;if("collection"===e&&"all"!==a)return!0}return!1})()&&!r&&m().createElement(m().Fragment,null,m().createElement(h.Layout.Box,{style:{textAlign:"center"}},(0,p.__)("No results found.")),m().createElement(h.Layout.Row,null,m().createElement(h.Button,{onClick:()=>l(n)},(0,p.__)("Reset Filter")))),t&&!c&&!r&&m().createElement(h.Layout.Box,{style:{textAlign:"center"}},(0,p.__)("This library doesn't have any items yet."))))},D=(e,t)=>{const{library:r}=_.uC.LibraryContext.use();return t.unshift({component:m().createElement(T,{item:e})}),t.unshift({component:m().createElement(P,{item:e}),shouldRender:r.permissions.edit_items}),t.unshift({component:m().createElement(U,{item:e})}),t},T=({item:e})=>{const{createNotice:t}=_.uC.ItemContext.use(),[r,a]=(0,u.useState)(!1),n=(0,L.getWpRest)().libraries(),s=e=>{!e||e.data.error?t({status:"error",content:(0,p.__)("Error previewing content.")}):window.open(e.data.url)};return m().createElement(h.Button,{onClick:()=>{a(!0),n.previewPost(e).then((e=>{s(e)})).catch((()=>{s()})).finally((()=>{a(!1)}))},disabled:r},(0,p.__)("Preview"))},P=({item:e})=>{const{currentPageView:t,isLocalhost:r}=(0,g.getSystemConfig)(),{id:a,type:n,isSingular:s}=t,[i,l]=(0,u.useState)(!1),{updateItems:o}=_.uC.LibraryContext.use(),{createNotice:c,setItem:d}=_.uC.ItemContext.use(),{updateFormValues:y}=_.uC.ItemFormContext.use(),b=(0,L.getWpRest)().libraries(),E=(0,L.getWpRest)().posts(),f=[{label:(0,p.__)("Cancel"),disabled:i,onClick:({closeDialog:e})=>e()}];s&&f.push({label:i?(0,p.__)("Updating..."):(0,p.__)("Update"),isSelected:!0,disabled:i,onClick:({closeDialog:t})=>{const r=(0,p.sprintf)((0,p.__)("Do you really want to update this library item and replace its content with the current %s? This cannot be undone."),n.toLowerCase());if(!confirm(r))return;l(!0);E.findById(a).then((({data:r})=>{_.d9.screenshotUrl(r.previewUrl).then((r=>{((r="")=>{b.syncLibraryPost(a,e,{screenshot:r}).then((e=>{d(e.data),o(e.data),y(e.data),c({status:"success",content:(0,p.__)("Library item updated!"),shouldDismiss:!1})})).catch((()=>{c({status:"error",content:(0,p.__)("Error updating library item."),shouldDismiss:!1})})).finally((()=>{l(!1),t()}))})(r)}))}))}});const[C,w]=h.Modal.useDialog({title:(0,p.__)("Update this Library Item"),message:m().createElement(A,null),buttons:f});return m().createElement(m().Fragment,null,m().createElement(h.Button,{onClick:C},(0,p.__)("Update")),m().createElement(w,null))},A=()=>{const{currentPageView:e}=(0,g.getSystemConfig)(),{intro:t,name:r,type:a,isSingular:n}=e;return n?m().createElement(m().Fragment,null,m().createElement("div",{style:{padding:"var(--fluid-med-space) 0"}},m().createElement("strong",null,t,":")," ",r),m().createElement("div",null,(0,p.sprintf)((0,p.__)("Updating this library item will replace its content with the content of the current %s."),a.toLowerCase()))):(0,p.__)("Updating is currently not available. To update this library item, navigate to the post or page you'd like to update it with and click the update button again.")},U=({item:e})=>{const{currentPageView:t,contentTypes:r}=(0,g.getSystemConfig)(),{createNotice:a}=_.uC.ItemContext.use(),[n,s]=(0,u.useState)(null),[i,l]=(0,u.useState)(!1),o=(0,L.getWpRest)().libraries(),c=R(),d=e=>{const{editUrl:t,type:n,postTypeRegistered:i}=e,o=r[n]?r[n].labels.singular:(0,p.__)("Content");s(null),l(!1),e.error?a({status:"error",shouldDismiss:!1,content:(0,p.__)("Error importing library item.")}):a({status:"success",shouldDismiss:!1,content:m().createElement(m().Fragment,null,i&&(0,p.__)("Library item imported!"),!i&&m().createElement(m().Fragment,null,(0,p.__)("The library item was not able to be imported.")," ",(0,p.__)("The post type"),' "',m().createElement("strong",null,n),'" ',(0,p.__)("is not registered on this site.")),t&&m().createElement("a",{style:{textDecoration:"underline",marginLeft:"var(--fluid-sm-space)"},onClick:()=>{window.location.href=t}},(0,p.sprintf)((0,p.__)("Edit %s."),o)))})},h=e=>{s(null),l(!1),!e||e.error?a({status:"error",shouldDismiss:!1,content:(0,p.sprintf)((0,p.__)("Error replacing %s."),t.type.toLowerCase())}):(a({status:"success",shouldDismiss:!1,content:(0,p.sprintf)((0,p.__)("%s replaced!"),t.type)}),window.location.reload())};return(0,u.useEffect)((()=>{"create"===n?o.importPost(e).then((t=>{t.data.error&&"post_type_not_registered"===t.data.error_code?a({status:"error",shouldDismiss:!1,content:m().createElement(m().Fragment,null,(0,p.__)("The library item was not able to be imported.")," ",(0,p.__)("The post type"),' "',m().createElement("strong",null,t.data.post_type),'" ',(0,p.__)("is not registered on this site."))}):(l(!0),c(t.data,e).then(d))})).catch((()=>{s(null),l(!1),a({status:"error",content:(0,p.__)("Error importing library item.")})})):"replace"===n&&(()=>{if(!t.isSingular)return alert((0,p.__)("Replacing is currently not available. Navigate to the post or page you'd like to replace and click the import button again.")),void s(null);const r=(0,p.sprintf)((0,p.__)("Do you really want to replace the current %s with this library item? This cannot be undone."),t.type.toLowerCase());confirm(r)?o.syncPost(t.id,e).then((t=>{l(!0),c(t.data,e).then((()=>{h(t.data)}))})).catch((()=>{h()})):s(null)})()}),[n]),m().createElement(m().Fragment,null,m().createElement("select",{value:"",onChange:e=>s(e.target.value),disabled:n},m().createElement("option",{value:""},!i&&!n&&(0,p.__)("Import..."),!i&&n&&(0,p.__)("Importing..."),i&&(0,p.__)("Importing media...")),m().createElement("option",{value:"create"},(0,p.__)("Create New")),m().createElement("option",{value:"replace"},t.isSingular?(0,p.sprintf)((0,p.__)("Replace Current %s"),t.type):(0,p.__)("Replace Current Page"))))},N=(e,t)=>{const{createNotice:r}=_.uC.ItemContext.use(),[a,n]=(0,u.useState)(!1),s=(0,L.getWpRest)();return t.unshift({label:(0,p.__)("Import"),onClick:()=>{n(!0),s.libraries().importItem(e).then((e=>{r({status:e.data.error?"error":"success",content:e.data.error?e.data.error:(0,p.__)("Item imported!")})})).catch((e=>{r({status:"error",content:e.response.data.message})})).finally((()=>{n(!1)}))},disabled:a}),t},O=(e,t)=>{const{createNotice:r}=_.uC.ItemContext.use(),[a,n]=(0,u.useState)(!1),s=(0,L.getWpRest)();return t.unshift({label:(0,p.__)("Import"),onClick:()=>{n(!0),s.libraries().importItem(e).then((e=>{r({status:e.data.error?"error":"success",content:e.data.error?e.data.error:(0,p.__)("Item imported!")})})).catch((e=>{r({status:"error",content:e.response.data.message})})).finally((()=>{n(!1)}))},disabled:a}),t},W=(e,t)=>{const{createNotice:r}=_.uC.ItemContext.use(),[a,n]=(0,u.useState)(!1),s=(0,L.getWpRest)();return t.unshift({label:(0,p.__)("Import"),onClick:()=>{n(!0),s.libraries().importItem(e).then((e=>{r({status:e.data.error?"error":"success",content:e.data.error?e.data.error:(0,p.__)("Item imported!")})})).catch((e=>{r({status:"error",content:e.response.data.message})})).finally((()=>{n(!1)}))},disabled:a}),t},H=(e,t)=>{const{adminURLs:r,themeSlug:a,themeParentSlug:n}=(0,g.getSystemConfig)(),{createNotice:s}=_.uC.ItemContext.use(),[i,l]=(0,u.useState)(!1),o=(0,L.getWpRest)().libraries(),c=()=>{const{name:t,slug:r,parent:s}=e.data.theme;return(!s||s.slug!==a&&s.slug!==n)&&(r!==a&&r!==n&&(s?alert((0,p.sprintf)((0,p.__)('The themes "%s" or "%s" must be active to apply or preview these settings.'),s.name,t)):alert((0,p.sprintf)((0,p.__)('The theme "%s" must be active to apply or preview these settings.'),t)),!0))};return t.unshift({label:(0,p.__)("Apply to Theme"),onClick:()=>{c()||confirm((0,p.__)("Do you really want to import these theme settings? This will update your site design and cannot be undone."))&&(l(!0),o.importThemeSettings(e.id).then((e=>{l(!1),e.data.data.error?s({status:"error",content:e.data.data.error,shouldDismiss:!1}):(s({status:"success",content:(0,p.__)("Settings imported!")}),window.location.reload())})))},disabled:i}),t.unshift({label:(0,p.__)("Preview"),onClick:()=>{c()||window.open(`${r.customizeBase}?fl-asst-customizer-preview-init=${e.id}`)}}),t},V=(e,t)=>{const{createNotice:r}=_.uC.ItemContext.use(),[a,n]=(0,u.useState)(!1),s=(0,L.getWpRest)();return t.unshift({label:(0,p.__)("Import"),onClick:()=>{n(!0),s.libraries().importItem(e).then((e=>{r({status:e.data.error?"error":"success",content:e.data.error?e.data.error:(0,p.__)("Item imported!")})})).catch((e=>{r({status:"error",content:e.response.data.message})})).finally((()=>{n(!1)}))},disabled:a}),t},$=()=>m().createElement("div",{style:{display:"flex",position:"absolute",top:0,right:0,bottom:0,left:0,width:"100%"}},m().createElement(_.uC.ItemDetail,{formConfig:c})),z=()=>{const{items:e,createNotice:t}=_.uC.LibraryContext.use(),[r,a]=(0,u.useState)(null),[n,s]=(0,u.useState)([]),[i,l]=(0,u.useState)(!1),[o,c]=(0,u.useState)(0),d=R(),g=(0,L.getWpRest)().libraries();return null!==r||i?m().createElement("div",{style:{gridColumn:"span 2"}},!i&&m().createElement("p",null,(0,p.__)("Import in progress. Navigating away from this view will stop the import process!")),m().createElement(Y,{progress:o/n.length*100}),m().createElement("p",{style:{fontStyle:"italic",fontSize:"12px",marginTop:"var(--fluid-sm-space)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},null!==r&&!i&&(0,p.sprintf)((0,p.__)("Importing %s"),r.name),i&&(0,p.__)("Import Complete!"))):m().createElement(h.Button,{onClick:()=>{confirm((0,p.__)("Are you sure you want to import this entire library into your site? This will import all items, including templates and media files. This action cannot be undone."))&&(async()=>{let r=0,n=0,i=[],o=e.map((e=>e.id));s(o),l(!1);for(const t of o){const s=e.find((e=>e.id===t));void 0!==s&&(a(s),"color"===s.type||"theme_settings"===s.type||"code"===s.type||("post"===s.type?await S().libraries.getItem(s.id).then((async e=>{await g.importPost(e.data).then((async t=>{if(t.data.error&&"post_type_not_registered"===t.data.error_code)return i.push({name:s.name,type:t.data.post_type}),void n++;await d(t.data,e.data)}))})):await g.importItem(s))),r++,c(r)}const u=i.map((e=>m().createElement("li",{key:e.name},e.name," (",e.type,")")));t(n<r?{status:"success",shouldDismiss:!1,content:m().createElement(m().Fragment,null,(0,p.__)("Library items imported!"),n>0&&m().createElement(m().Fragment,null," ",(0,p.__)("Some items were not able to be imported due to these post types not being registered on this site: "),m().createElement("br",null),m().createElement("ul",null,u)))}:{status:"error",shouldDismiss:!1,content:m().createElement(m().Fragment,null,(0,p.__)("The selected items were not able to be imported due to these post types not being registered on this site: "),m().createElement("br",null),m().createElement("ul",null,u))}),c(0),l(!0)})()},title:(0,p.__)("Import all items in this library into your site.")},(0,p.__)("Import Library"))},Y=({progress:e})=>m().createElement("div",{style:{background:"var(--fluid-transparent-10)",borderRadius:"var(--fluid-radius)",height:"6px"}},m().createElement("div",{style:{background:"var(--fluid-transparent-4)",borderRadius:"var(--fluid-radius)",height:"6px",width:`${e}%`}})),G=()=>{const{library:e}=_.uC.LibraryContext.use(),[t,r]=(0,u.useState)(!1);return m().createElement(h.Button,{title:(0,p.__)("Download a ZIP file of all items in this library."),disabled:t,onClick:async()=>{r(!0);const t=document.createElement("form"),a=document.createElement("input");t.method="POST",t.action=`${S().http.defaults.baseURL}/libraries/${e.id}/download`,a.name="token",a.type="hidden",a.value=S().session.getToken(),t.appendChild(a),document.body.appendChild(t),t.submit(),t.remove(),r(!1)}},(0,p.__)("Download ZIP"))},M=()=>{const{isReadOnly:e,library:t}=_.uC.LibraryContext.use(),{cloudUser:r}=(0,g.useSystemState)(),a=r.id===t.permissions.permissions_user_id&&!t.permissions.owner,n=t.permissions.shared&&!t.permissions.owner||a;return m().createElement(m().Fragment,null,!e&&m().createElement(m().Fragment,null,m().createElement(h.Layout.Box,{padY:!1},m().createElement(h.Page.Section,{label:(0,p.__)("Actions")},m().createElement(h.Button.Group,{appearance:"grid"},m().createElement(z,null),m().createElement(G,null))))),!n&&m().createElement(h.Layout.Box,{padY:!1,className:"fl-asst-library-settings"},m().createElement(h.Page.Section,{label:(0,p.__)("Library Settings"),padY:!1},m().createElement(_.uC.LibrarySettingsForm,null))),!e&&m().createElement(m().Fragment,null,!n&&m().createElement(h.Layout.Box,{padY:!1},m().createElement(h.Page.Section,{label:(0,p.__)("Library Collections")},m().createElement(_.uC.LibraryCollectionsForm,null))),n&&t.permissions.edit_collections&&m().createElement(h.Layout.Box,{padY:!1},m().createElement(h.Page.Section,{label:(0,p.__)("Library Collections")},m().createElement(_.uC.LibraryCollectionsForm,null)))),t.permissions.delete&&m().createElement(h.Layout.Box,null,m().createElement(h.Page.Section,{label:(0,p.__)("Danger Zone")},m().createElement(h.Layout.Headline,null,(0,p.__)("Delete This Library")),m().createElement("p",{style:{margin:"0"}},(0,p.__)("Once a library has been deleted, it is gone forever. Please be sure you want to delete this library."))),m().createElement(_.uC.LibraryDeleteForm,null)))},j=()=>{const{pathname:e}=(0,d.useLocation)();return m().createElement(_.uC.LibraryDetail,null,m().createElement("div",{style:{visibility:e.includes("/items/")?"hidden":"",width:"100%",flex:"1 1 auto",display:"flex",position:"absolute",top:0,bottom:0}},m().createElement(h.Page,{title:(0,p.__)("Library"),shouldShowBackButton:!0,actions:m().createElement(b,null),padX:!1,padY:!1},m().createElement(d.Switch,null,m().createElement(d.Route,{path:"/libraries/:id/settings",component:M}),m().createElement(d.Route,{path:"/libraries/:id",component:B})))),m().createElement(d.Switch,null,m().createElement(d.Route,{path:"/libraries/:id/item/:itemId",component:$})))},Z=()=>{const{cloudConfig:e}=(0,g.getSystemConfig)(),{cloudUser:t}=(0,g.useSystemState)(),[r,a]=(0,u.useState)(!1),n=()=>m().createElement(m().Fragment,null,m().createElement(h.Menu.Item,{href:e.appUrl,target:"_blank"},(0,p.__)("Launch Cloud")),m().createElement(h.Menu.Item,{onClick:()=>S().auth.logout()},(0,p.__)("Disconnect")));return m().createElement(h.Menu,{content:m().createElement(n,null),isShowing:r,onOutsideClick:()=>a(!1),style:{zIndex:9}},m().createElement(h.Button,{onClick:()=>a(!r),className:"fl-asst-cloud-gravatar-link",appearance:"elevator",size:"sm",style:{backgroundImage:`url(${t.gravatar.sm})`,backgroundSize:"contain",height:"25px",width:"25px",minHeight:"0",minWidth:"0"}}))},q=(e,t,r)=>{const a=(e="user",t=null)=>{const a=t?r[e][t]:r[e];return a?a.map(_.tm):[]},n=a("access"),s=[{key:"user",label:e?e.name:"",avatar:e.avatar?e.avatar.sizes.thumb.url:e.gravatar.md,to:"/libraries/user",items:a(),canCreateLibraries:!0},{key:"shared",label:(0,p.__)("Shared Libraries"),avatar:m().createElement(h.Icon.Shared,null),to:"/libraries/shared",isEnabled:!!r?.shared?.length,items:a("shared"),canCreateLibraries:!1},{key:"community",label:(0,p.__)("Community Libraries"),avatar:m().createElement(h.Icon.Swirl,null),isEnabled:!!n.length,items:n,canCreateLibraries:!1},...((e=[])=>e.map((e=>({...(0,_.$R)(e),items:a("team",e.id),canCreateLibraries:e.permissions.edit_libraries}))))(t)];return s},X=({preloadedLib:e=!1,preloadedTeams:t=!1})=>{const{cloudUser:r}=(0,g.useSystemState)(),{filter:a,libraries:n,teams:s}=(0,g.useAppState)("libraries"),{owner:i,...l}=a,o=e||n,c=t||s;return m().createElement(h.Page,{title:(0,p.__)("Libraries"),icon:m().createElement(h.Icon.Library,{context:"sidebar"}),shouldShowBackButton:!1,actions:m().createElement(Z,null),padX:!1,padY:!1},m().createElement(_.PH,{sections:q(r,c,o),isLoading:!1,linkSectionHeaders:!1,displayItemsAs:"grid"}))}},8168:(e,t,r)=>{function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},a.apply(null,arguments)}r.d(t,{A:()=>a})}}]);