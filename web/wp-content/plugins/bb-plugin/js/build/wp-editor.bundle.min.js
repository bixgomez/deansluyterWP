(()=>{var e={870:()=>{const{registerStore:e}=wp.data,t={launching:!1};e("fl-builder",{reducer:(e=t,o)=>("SET_LAUNCHING"===o.type&&(e.launching=o.launching),e),actions:{setLaunching:e=>({type:"SET_LAUNCHING",launching:e})},selectors:{isLaunching:e=>e.launching}})}},t={};function o(i){var s=t[i];if(void 0!==s)return s.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,o),n.exports}(()=>{"use strict";const e=(t=null,o=!1)=>{const{wp:i={}}=window||{},{data:s={},blocks:n={}}=i,{dispatch:c,select:l}=s,{createBlock:r}=n,{replaceBlock:a}=c("core/block-editor");if(!0!=(null!==t&&"object"==typeof t&&null!==t.clientId&&"string"==typeof t.clientId))return!1;const u=l("core/block-editor").getBlock(t.clientId);if(1!=!u){const{clientId:t="",isValid:s=!0,innerBlocks:n=[]}=u,c=null!==n&&Array.isArray(n)&&n.length>=1;!0!==s&&(a(t,(({name:e="",attributes:t={},innerBlocks:o=[]})=>r(e,t,o))(u)),!0===o&&i.data.dispatch("core/editor").savePost()),c&&n.forEach((t={})=>{e(t,o)})}return!1},{wp:t={}}=window||{},{domReady:i,data:s}=t;jQuery(document).on("fl-builder-fix-blocks",function(){!0==(!0===(!0===jQuery("body").hasClass("post-php")&&jQuery(".block-editor").length>=1&&jQuery("body").hasClass("fl-builder-blocks"))&&!0==(void 0!==i&&void 0!==s))&&((t=!1)=>{const{wp:o={}}=window||{},{domReady:i,data:s={}}=o,{select:n}=s;i(function(){setTimeout(function(){const o=n("core/block-editor").getBlocks();!0===(Array.isArray(o)&&o.length>=1)&&o.forEach((o={})=>{e(o,t)})},1)})})(!1)}),o(870);const{builder:n,strings:c,urls:l}=FLBuilderConfig,{rawHandler:r,serialize:a}=wp.blocks,{Button:u,Placeholder:d,Spinner:p}=wp.components,{compose:h}=wp.compose,{withDispatch:b,withSelect:m}=wp.data,{Component:k}=wp.element,g=h(b((e,t)=>{const o=e("core/block-editor"),i=e("core/editor"),s=e("fl-builder");return{removeBlocks:o.removeBlocks,replaceBlocks:o.replaceBlocks,savePost:i.savePost,setLaunching:s.setLaunching}}),m(e=>{const t=e("core/block-editor"),o=(e("core/editor"),e("fl-builder"));return{blockCount:t.getBlockCount(),blocks:t.getBlocks(),isLaunching:o.isLaunching()}}))(class extends k{constructor(){super(...arguments)}componentDidMount(){const{blockCount:e}=this.props;1===e&&this.toggleEditor("disable")}componentWillUnmount(){this.toggleEditor("enable")}render(){const{blockCount:e,onReplace:t,isLaunching:o}=this.props;let i,s,l;return 1===e?(i=n.access?c.launch:c.view,s=this.launchBuilder.bind(this)):(i=c.convert,s=this.convertToBuilder.bind(this)),l=n.enabled?c.active:c.description,!1===n.showui?"":React.createElement(d,{key:"placeholder",instructions:l,label:c.title,className:"fl-builder-layout-launch-view"},o&&React.createElement(p,null),!o&&React.createElement(u,{isLarge:!0,isPrimary:!0,type:"submit",onClick:s},i),!o&&React.createElement(u,{isLarge:!0,type:"submit",onClick:this.convertToBlocks.bind(this)},c.editor))}toggleEditor(e="enable"){const{classList:t}=document.body,o="fl-builder-layout-enabled";"enable"===e?t.contains(o)&&t.remove(o):t.contains(o)||t.add(o)}launchBuilder(){const{savePost:e,setLaunching:t}=this.props;t(!0),wp.data.select("core/editor").getEditedPostAttribute("title")||wp.data.dispatch("core/editor").editPost({title:wp.i18n.__("(no title)")}),e().then(()=>{setTimeout(function(){window.top.location.href=n.access?l.edit:l.view},2e3)})}convertToBuilder(){const{clientId:e,blocks:t,setAttributes:o,removeBlocks:i}=this.props,s=a(t),n=t.map(e=>e.clientId).filter(t=>t!==e);o({content:s.replace(/<!--(.*?)-->/g,"")}),i(n),this.launchBuilder()}convertToBlocks(){const{attributes:e,clientId:t,replaceBlocks:o,onReplace:i}=this.props;e.content&&!confirm(c.warning)||(e.content?o([t],r({HTML:e.content,mode:"BLOCKS"})):i([]))}}),{builder:B,strings:w,urls:v}=FLBuilderConfig,{rawHandler:f,serialize:y}=wp.blocks,{Button:L,Placeholder:C,Spinner:P}=wp.components,{compose:E}=wp.compose,{subscribe:T,withDispatch:I,withSelect:R}=wp.data,{Component:S}=wp.element,x=E(I((e,t)=>{const o=e("core/editor"),i=e("fl-builder");return{savePost:o.savePost,removeBlocks:o.removeBlocks,replaceBlocks:o.replaceBlocks,setLaunching:i.setLaunching}}),R(e=>{const t=e("core/editor"),o=e("fl-builder");return{blockCount:t.getBlockCount(),blocks:t.getBlocks(),isSavingPost:t.isSavingPost(),isLaunching:o.isLaunching()}}))(class extends S{constructor(){super(...arguments),this.unsubscribe=T(this.storeDidUpdate.bind(this))}storeDidUpdate(){const{isLaunching:e,isSavingPost:t}=this.props;e&&!t&&(this.unsubscribe(),this.redirectToBuilder())}componentDidMount(){const{blockCount:e}=this.props;1===e&&this.toggleEditor("disable")}componentWillUnmount(){this.unsubscribe(),this.toggleEditor("enable")}render(){const{blockCount:e,onReplace:t,isLaunching:o}=this.props;let i,s,n;return 1===e?(i=B.access?w.launch:w.view,s=this.launchBuilder.bind(this)):(i=w.convert,s=this.convertToBuilder.bind(this)),n=B.enabled?w.active:w.description,!1===B.showui?"":React.createElement(C,{key:"placeholder",instructions:n,icon:"welcome-widgets-menus",label:w.title,className:"fl-builder-layout-launch-view"},o&&React.createElement(P,null),!o&&React.createElement(L,{isLarge:!0,isPrimary:!0,type:"submit",onClick:s},i),!o&&React.createElement(L,{isLarge:!0,type:"submit",onClick:this.convertToBlocks.bind(this)},w.editor))}toggleEditor(e="enable"){const{classList:t}=document.body,o="fl-builder-layout-enabled";"enable"===e?t.contains(o)&&t.remove(o):t.contains(o)||t.add(o)}redirectToBuilder(){window.location.href=B.access?v.edit:v.view}launchBuilder(){const{savePost:e,setLaunching:t}=this.props;t(!0),e()}convertToBuilder(){const{clientId:e,blocks:t,setAttributes:o,removeBlocks:i}=this.props,s=y(t),n=t.map(e=>e.clientId).filter(t=>t!==e);o({content:s.replace(/<!--(.*?)-->/g,"")}),i(n),this.launchBuilder()}convertToBlocks(){const{attributes:e,clientId:t,replaceBlocks:o,onReplace:i}=this.props;e.content&&!confirm(w.warning)||(e.content?o([t],f({HTML:e.content,mode:"BLOCKS"})):i([]))}}),{builder:A,strings:F}=FLBuilderConfig,{version:M}=FLBuilderConfig.wp,{registerBlockType:N}=wp.blocks,{RawHTML:D}=wp.element;(A.access&&A.unrestricted||A.enabled)&&N("fl-builder/layout",{title:F.title,description:F.description,icon:"welcome-widgets-menus",category:"layout",useOnce:!0,supports:{customClassName:!1,className:!1,html:!1},attributes:{content:{type:"string",source:"html"}},edit:parseFloat(M)<5.3?x:g,save:({attributes:e})=>React.createElement(D,null,e.content)});const{builder:j,strings:H,urls:Q}=FLBuilderConfig,{createBlock:U,serialize:_}=wp.blocks,{Button:G}=wp.components,{compose:z}=wp.compose,{withDispatch:O,withSelect:K}=wp.data,{PluginMoreMenuItem:W}=wp.editPost,{Component:V}=wp.element,q=z(O((e,t)=>{const o=e("core/block-editor"),i=e("core/editor"),s=e("fl-builder");return{insertBlock:o.insertBlock,removeBlocks:o.removeBlocks,savePost:i.savePost,setLaunching:s.setLaunching}}),K(e=>({blocks:e("core/block-editor").getBlocks()})))(class extends V{render(){return this.hasBuilderBlock()&&(jQuery("body").addClass("fl-builder-blocks"),jQuery(document).trigger("fl-builder-fix-blocks")),React.createElement(W,{onClick:this.menuItemClicked.bind(this)},this.hasBuilderBlock()?H.launch:H.convert)}hasBuilderBlock(){const{blocks:e}=this.props;return!!e.filter(e=>"fl-builder/layout"===e.name).length}menuItemClicked(){this.hasBuilderBlock()?this.launchBuilder():this.convertToBuilder()}convertToBuilder(){const{blocks:e,insertBlock:t,removeBlocks:o}=this.props,i=e.map(e=>e.clientId),s=_(e).replace(/<!--(.*?)-->/g,"");t(U("fl-builder/layout",{content:s}),0),o(i)}launchBuilder(){const{savePost:e,setLaunching:t}=this.props;t(!0),wp.data.select("core/editor").getEditedPostAttribute("title")||wp.data.dispatch("core/editor").editPost({title:wp.i18n.__("(no title)")}),e().then(()=>{setTimeout(function(){window.location.href=j.access?Q.edit:Q.view},2e3)})}}),{strings:J}=FLBuilderConfig,{createBlock:X,serialize:Y}=wp.blocks,{Button:Z}=wp.components,{compose:$}=wp.compose,{withDispatch:ee,withSelect:te}=wp.data,{PluginSidebarMoreMenuItem:oe}=wp.editPost,{Component:ie}=wp.element,se=$(ee((e,t)=>{const o=e("core/editor"),i=e("core/edit-post"),s=e("fl-builder");return{savePost:o.savePost,insertBlock:o.insertBlock,removeBlocks:o.removeBlocks,closeGeneralSidebar:i.closeGeneralSidebar,setLaunching:s.setLaunching}}),te(e=>({blocks:e("core/editor").getBlocks()})))(class extends ie{render(){return React.createElement(oe,null,React.createElement("div",{className:"fl-builder-plugin-sidebar-button",onClick:this.menuItemClicked.bind(this)}),this.hasBuilderBlock()?J.launch:J.convert)}hasBuilderBlock(){const{blocks:e}=this.props;return!!e.filter(e=>"fl-builder/layout"===e.name).length}menuItemClicked(){const{closeGeneralSidebar:e}=this.props;this.hasBuilderBlock()?this.launchBuilder():this.convertToBuilder(),setTimeout(e,100)}convertToBuilder(){const{blocks:e,insertBlock:t,removeBlocks:o}=this.props,i=e.map(e=>e.clientId),s=Y(e).replace(/<!--(.*?)-->/g,"");t(X("fl-builder/layout",{content:s}),0),o(i)}launchBuilder(){const{savePost:e,setLaunching:t}=this.props;t(!0),e()}}),{version:ne}=FLBuilderConfig.wp,{registerPlugin:ce}=wp.plugins;ce("fl-builder-plugin-sidebar",{icon:"welcome-widgets-menus",render:parseFloat(ne)<5.3?se:q})})()})();